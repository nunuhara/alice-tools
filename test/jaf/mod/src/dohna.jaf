
int test_g;

interface IShopButton {
	void Update(void);
	void SetPos(int x, int y);
};

struct CustomButton : IShopButton {
	void Update(void) {
		test_g = 42;
	}
	void SetPos(int x, int y) {
	}
	~CustomButton() {
		test_g = 0;
	}
};

IShopButton ret_iface(void)
{
	return new CustomButton();
}

void test_interface(void)
{
	{
		IShopButton p = ret_iface();
		p.Update();
		assert(test_g == 42);
	}
	assert(test_g == 0);
}

option<int> ret_option(int a)
{
	if (a)
		return Option::Some(a);
	return Option::None;
}

void test_option(void)
{
	option<int> opt_some = ret_option(1);
	option<int> opt_none = ret_option(0);
	assert(opt_some.IsSome());
	assert(opt_none.IsNone());
	assert(opt_some.Value(2) == 1);
	assert(opt_none.Value(2) == 2);
}

TeachingItemType ret_enum_arg(TeachingItemType e)
{
	if (e == TeachingItemType::Invalid)
		return TeachingItemType::Looks;
	return e;
}

void test_enum(void)
{
	TeachingItemType e;
	assert(e == TeachingItemType::Invalid);
	assert(e != TeachingItemType::Looks);
	assert(ret_enum_arg(e) == TeachingItemType::Looks);
	assert((int)e == 0);
	assert((string)e == "Invalid");
	assert(TeachingItemType::Parse#1(1).Value(TeachingItemType::Invalid) == TeachingItemType::Looks);
	assert(TeachingItemType::Parse("Looks").Value(TeachingItemType::Invalid) == TeachingItemType::Looks);
}

override int main(void)
{
	test_interface();
	test_option();
	test_enum();
	return super();
}
